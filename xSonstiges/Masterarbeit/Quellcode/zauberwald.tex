\begin{Verbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Zauberwald Server\PYZhy{}Side Plugin for Fabula}

\PY{l+s+sd}{   Copyright 2013 Linda Kerkhoff}
\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}

\PY{c}{\PYZsh{} This file is part of Zauberwald.}
\PY{c}{\PYZsh{}}
\PY{c}{\PYZsh{} Zauberwald is free software: you can redistribute it and/or modify}
\PY{c}{\PYZsh{} it under the terms of the GNU General Public License as published by}
\PY{c}{\PYZsh{} the Free Software Foundation, either version 3 of the License, or}
\PY{c}{\PYZsh{} (at your option) any later version.}
\PY{c}{\PYZsh{}}
\PY{c}{\PYZsh{} Zauberwald is distributed in the hope that it will be useful,}
\PY{c}{\PYZsh{} but WITHOUT ANY WARRANTY; without even the implied warranty of}
\PY{c}{\PYZsh{} MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
\PY{c}{\PYZsh{} GNU General Public License for more details.}
\PY{c}{\PYZsh{}}
\PY{c}{\PYZsh{} See \PYZlt{}http://www.gnu.org/licenses/\PYZgt{}.}

\PY{c}{\PYZsh{} Work started on 05. Aug 2013.}

\PY{k+kn}{import} \PY{n+nn}{pygame}
\PY{k+kn}{import} \PY{n+nn}{fabula.plugins.pygameui}
\PY{k+kn}{from} \PY{n+nn}{fabula.plugins.audioui} \PY{k+kn}{import} \PY{n}{AudioTextField}
\PY{k+kn}{from} \PY{n+nn}{fabula.plugins.audioui} \PY{k+kn}{import} \PY{n}{TextMenuList}

\PY{n}{PLANES} \PY{o}{=} \PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{pygameui}\PY{o}{.}\PY{n}{planes}

\PY{c}{\PYZsh{} Constant Zauberwald player IDs}
\PY{c}{\PYZsh{}}
\PY{n}{ID\PYZus{}KUNI} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{kuni}\PY{l+s}{\PYZsq{}}
\PY{n}{ID\PYZus{}CASSANDRA} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{cassandra}\PY{l+s}{\PYZsq{}}

\PY{k}{class} \PY{n+nc}{ZWServerPlugin}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{serverside}\PY{o}{.}\PY{n}{DefaultGame}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}This is the serverside Plugin for the Zauberwald game.}

\PY{l+s+sd}{    Attributes:}

\PY{l+s+sd}{    ZWServerPlugin.sentences\PYZus{}cassandra}
\PY{l+s+sd}{        Sentences to save the potential conversation possibilities with Kuni.}
\PY{l+s+sd}{        Initially Introduction sentences.}

\PY{l+s+sd}{    ZWServerPlugin.sentences\PYZus{}kuni}
\PY{l+s+sd}{        Sentences to save the potential conversation possibilities with}
\PY{l+s+sd}{        Cassandra. Initially Introduction sentences.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}

    \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{host}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Call base class \PYZus{}\PYZus{}init\PYZus{}\PYZus{}(), add custom logic.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{c}{\PYZsh{} Call base class}
        \PY{c}{\PYZsh{}}
        \PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{serverside}\PY{o}{.}\PY{n}{DefaultGame}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{host}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}kuni} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                               \PY{l+s}{\PYZsq{}}\PY{l+s}{Wer bist du?}\PY{l+s}{\PYZsq{}}\PY{p}{]}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}cassandra} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                     \PY{l+s}{\PYZsq{}}\PY{l+s}{Mit wem habe ich die Ehre?}\PY{l+s}{\PYZsq{}}\PY{p}{]}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired} \PY{o}{=} \PY{n+nb+bp}{False}

        \PY{k}{return}

    \PY{k}{def} \PY{n+nf}{respond}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{event}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Add an Event from condition\PYZus{}response\PYZus{}dict corresponding to the Event given to message\PYZus{}for\PYZus{}host.}

\PY{l+s+sd}{           If the Event is not found, return AttemptFailedEvent.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{c}{\PYZsh{} Save the room from where the event was to current\PYZus{}room}
        \PY{c}{\PYZsh{}}
        \PY{n}{room} \PY{o}{=} \PY{n+nb+bp}{None}

        \PY{k}{for} \PY{n}{current\PYZus{}room} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}id}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{n}{event}\PY{o}{.}\PY{n}{identifier} \PY{o+ow}{in} \PY{n}{current\PYZus{}room}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{room} \PY{o}{=} \PY{n}{current\PYZus{}room}

        \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{messages} \PY{o}{=} \PY{p}{[}\PY{p}{]}

        \PY{c}{\PYZsh{} Call the proper respond method for the current room to handle}
        \PY{c}{\PYZsh{} room specific events}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{n}{room}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{default}\PY{l+s}{\PYZsq{}}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}respond\PYZus{}room\PYZus{}default}\PY{p}{(}\PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}

        \PY{k}{elif} \PY{n}{room}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}respond\PYZus{}room\PYZus{}cassandra}\PY{p}{(}\PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}

        \PY{k}{elif} \PY{n}{room}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}respond\PYZus{}room\PYZus{}kuni}\PY{p}{(}\PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}

        \PY{k}{elif} \PY{n}{room}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{room\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{:}
            \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}respond\PYZus{}room\PYZus{}entry}\PY{p}{(}\PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}

        \PY{c}{\PYZsh{} Check events which can happen in all rooms for example perception}
        \PY{c}{\PYZsh{} of items when they are carried around and SaysEvents between}
        \PY{c}{\PYZsh{} Cassandra and Kuni.}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToTalkToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} sentences\PYZus{}kuni is changed according to game logic and contains the}
            \PY{c}{\PYZsh{} right phrases at the right time}
            \PY{c}{\PYZsh{}}
            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{CanSpeakEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{sentences}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}kuni}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToTalkToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} sentences\PYZus{}cassandra is changed according to game logic and}
            \PY{c}{\PYZsh{} contains the right phrases at the right time}
            \PY{c}{\PYZsh{}}
            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{CanSpeakEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{sentences}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}cassandra}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein Brecheisen, das könnte noch nützlich sein.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh, ein Stückchen Kuchen, sieht das gut aus! }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Aber ich bin ja auf Diät.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein wirklich schönes Instrument, leider fehlen ihre Saiten}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Eine wohlklingende Laute!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein mit Tau gefüllter Blütenkelch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{if} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Tau von den Blumen}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein schöner Blütenkelch}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Saite einer Harfe}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Eine funktionierende Laute.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Kelch ist jetzt mit dem Tau gefüllt}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                           \PY{n+nb+bp}{True}\PY{p}{,}
                                                           \PY{n+nb+bp}{True}\PY{p}{,}
                                                           \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                       \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                             \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PicksUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                             \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Warum sollte ich den Blütenkelch mit Tau benetzen, }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{der sieht ganz sauber aus.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{perception\PYZus{}of\PYZus{}kuni} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{Der Gnom Kuni.}\PY{l+s}{\PYZsq{}}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}kuni}\PY{p}{:}

                \PY{n}{perception\PYZus{}of\PYZus{}kuni} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ein kleiner Gnom, ob der wohl weiß, wo es zum Zauberwald geht?}\PY{l+s}{\PYZsq{}}


            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{n}{perception\PYZus{}of\PYZus{}kuni}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{:}

            \PY{n}{perception\PYZus{}of\PYZus{}cassandra} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Fee Cassandra}\PY{l+s}{\PYZsq{}}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}cassandra}\PY{p}{:}

                \PY{n}{perception\PYZus{}of\PYZus{}cassandra} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hm, eine Fee...allerdings sieht sie doch ein wenig rundlich aus!}\PY{l+s}{\PYZsq{}}


            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{n}{perception\PYZus{}of\PYZus{}cassandra}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Game Logic done}

        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{event\PYZus{}list}\PY{p}{)}\PY{p}{:}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{returning corresponding events}\PY{l+s}{\PYZdq{}}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{n}{event\PYZus{}list}

        \PY{k}{else}\PY{p}{:}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{no action defined for event }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{, returning AttemptFailedEvent to host}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{event}\PY{p}{)}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{AttemptFailedEvent}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{identifier}\PY{p}{)}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{queue\PYZus{}messages}\PY{p}{(}\PY{o}{*}\PY{n}{messages}\PY{p}{)}

        \PY{k}{return}

    \PY{k}{def} \PY{n+nf}{process\PYZus{}message}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{message}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Calls the base class and adds spawning functionality for teleporting tiles to switch rooms.}

\PY{l+s+sd}{           Returns ZWServerPlugin.message\PYZus{}for\PYZus{}host.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{c}{\PYZsh{} Call base class}
        \PY{c}{\PYZsh{} This will add event to self.message\PYZus{}for\PYZus{}host}
        \PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{serverside}\PY{o}{.}\PY{n}{DefaultGame}\PY{o}{.}\PY{n}{process\PYZus{}message}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{message}\PY{p}{)}

        \PY{c}{\PYZsh{} Kuni teleporting}
        \PY{c}{\PYZsh{} (6, 0, \PYZsq{}default\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Kuni to room\PYZus{}kuni}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{p}{(}\PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{default}\PY{l+s}{\PYZdq{}}
           \PY{o+ow}{and} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{owner\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
                \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{owner\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{:}

                \PY{c}{\PYZsh{} Cassandra needs cobweb to leave the room, Kuni is not allowed to leave}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                               \PY{l+s}{\PYZsq{}}\PY{l+s}{Du solltest vielleicht vorher Cassandra}\PY{l+s}{\PYZsq{}}
                                                                               \PY{l+s}{\PYZsq{}}\PY{l+s}{mit den Flügel helfen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{process\PYZus{}TriesToMoveEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToMoveEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                      \PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Tür zum Gnomenweg ist offen! Da gehts zum Zauberwald lang!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete client}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Load room\PYZus{}kuni for kuni and spawn kuni at position (1, 1)}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                        \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}kuni}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                        \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete pending movements if present}
                \PY{c}{\PYZsh{}}
                \PY{k}{if} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                    \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}kuni}\PY{l+s}{\PYZdq{}}
           \PY{o+ow}{and} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} (7, 4 \PYZsq{}room\PYZus{}kuni\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Kuni to \PYZsq{}room\PYZus{}entry\PYZsq{})}
            \PY{c}{\PYZsh{}}
            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{:}

                \PY{c}{\PYZsh{} Delete client}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Load room\PYZus{}entry for kuni and spawn kuni at position (1, 3)}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                        \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}entry}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                        \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete pending movements if present}
                \PY{c}{\PYZsh{}}
                \PY{k}{if} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                    \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}

            \PY{c}{\PYZsh{} (1, 0 \PYZsq{}room\PYZus{}kuni\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Kuni to \PYZsq{}room\PYZus{}default\PYZsq{})}
            \PY{c}{\PYZsh{}}
            \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}

                \PY{c}{\PYZsh{} Delete client}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Load default room for kuni and spawn kuni at position (5, 0)}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                        \PY{l+s}{\PYZdq{}}\PY{l+s}{default}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                        \PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete pending movements if present}
                \PY{c}{\PYZsh{}}
                \PY{k}{if} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                    \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}

        \PY{c}{\PYZsh{} (1, 4, \PYZsq{}room\PYZus{}entry\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Kuni to room\PYZus{}kuni}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}entry}\PY{l+s}{\PYZdq{}}
           \PY{o+ow}{and} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} Delete client}
            \PY{c}{\PYZsh{}}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}

            \PY{c}{\PYZsh{} Load room\PYZus{}kuni for kuni and spawn kuni at position (6, 4)}
            \PY{c}{\PYZsh{}}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                    \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}kuni}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                    \PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{c}{\PYZsh{} Delete pending movements if present}
            \PY{c}{\PYZsh{}}
            \PY{k}{if} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}

        \PY{c}{\PYZsh{} Cassandra teleporting}
        \PY{c}{\PYZsh{} (6, 3, \PYZsq{}default\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Cassandra to room\PYZus{}kuni}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{default}\PY{l+s}{\PYZdq{}}
           \PY{o+ow}{and} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{owner\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
                \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{owner\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{:}

                \PY{c}{\PYZsh{} Kuni needs key to leave the room, Cassandra is not allowed to leave}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                               \PY{l+s}{\PYZsq{}}\PY{l+s}{Du bist zu schwer um mit dem }\PY{l+s}{\PYZsq{}}
                                                                               \PY{l+s}{\PYZsq{}}\PY{l+s}{Schlüssel über den Fluss zu fliegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{process\PYZus{}TriesToMoveEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToMoveEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                      \PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{k}{else}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Meine Flügel sind wieder heil, ich kann fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete client}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Load room\PYZus{}cassandra for Cassandra and spawn her at position (1, 2)}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                        \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}cassandra}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                        \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete pending movements if present}
                \PY{c}{\PYZsh{}}
                \PY{k}{if} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                    \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}cassandra}\PY{l+s}{\PYZdq{}}
           \PY{o+ow}{and} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} (7, 3 \PYZsq{}room\PYZus{}cassandra\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Cassandra to \PYZsq{}room\PYZus{}entry\PYZsq{})}
            \PY{c}{\PYZsh{}}
            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{:}

                \PY{c}{\PYZsh{} Delete client}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Load room\PYZus{}entry for Cassandra and spawn her at position (5, 3)}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                        \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}entry}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                        \PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete pending movements if present}
                \PY{c}{\PYZsh{}}
                \PY{k}{if} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                    \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}

            \PY{c}{\PYZsh{} (0, 2 \PYZsq{}room\PYZus{}cassandra\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Cassandra to \PYZsq{}room\PYZus{}default\PYZsq{})}
            \PY{c}{\PYZsh{}}
            \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}

                \PY{c}{\PYZsh{} Delete client}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Load default room for Cassandra and spawn her at position (5, 3)}
                \PY{c}{\PYZsh{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                        \PY{l+s}{\PYZdq{}}\PY{l+s}{default}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                        \PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} Delete pending movements if present}
                \PY{c}{\PYZsh{}}
                \PY{k}{if} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                    \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}


        \PY{c}{\PYZsh{} (5, 4, \PYZsq{}room\PYZus{}entry\PYZsq{}) \PYZhy{}\PYZgt{} Teleports Cassandra to room\PYZus{}cassandra}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{identifier} \PY{o}{==} \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}entry}\PY{l+s}{\PYZdq{}}
           \PY{o+ow}{and} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
           \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} Delete client}
            \PY{c}{\PYZsh{}}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{)}

            \PY{c}{\PYZsh{} Load room\PYZus{}cassandra for Cassandra and spawn her at position (6, 3)}
            \PY{c}{\PYZsh{}}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                    \PY{l+s}{\PYZdq{}}\PY{l+s}{room\PYZus{}cassandra}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                                    \PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{c}{\PYZsh{} Delete pending movements if present}
            \PY{c}{\PYZsh{}}
            \PY{k}{if} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{k}{del} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tries\PYZus{}to\PYZus{}move\PYZus{}dict}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}

        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}

    \PY{k}{def} \PY{n+nf}{process\PYZus{}TriesToPickUpEvent}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{event}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Call base, but also respond().}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{c}{\PYZsh{} First call base...}
        \PY{c}{\PYZsh{}}
        \PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{serverside}\PY{o}{.}\PY{n}{DefaultGame}\PY{o}{.}\PY{n}{process\PYZus{}TriesToPickUpEvent}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}
                                                                         \PY{n}{event}\PY{p}{)}

        \PY{c}{\PYZsh{} Problem with Fabula: Unfortunately, the process\PYZus{}... handlers do not}
        \PY{c}{\PYZsh{} set a return value. So check whether the most recent event is not}
        \PY{c}{\PYZsh{} AttemptFailed.}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{o+ow}{not} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{fabula}\PY{o}{.}\PY{n}{AttemptFailedEvent}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{respond}\PY{p}{(}\PY{n}{event}\PY{p}{)}

        \PY{k}{return}

    \PY{k}{def} \PY{n+nf}{process\PYZus{}TriesToDropEvent}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{event}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Copied from DefaultGame.}
\PY{l+s+sd}{           Changed to disable non item\PYZhy{}targets. Game Logic depends on dropping}
\PY{l+s+sd}{           items only on other items. Think Monkey Island.}
\PY{l+s+sd}{           If the target is an Entity, forward to respond().}
\PY{l+s+sd}{           If the target is a position, send a PerceptionEvent.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{room} \PY{o}{=} \PY{n+nb+bp}{None}

        \PY{k}{for} \PY{n}{current\PYZus{}room} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}id}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{n}{event}\PY{o}{.}\PY{n}{identifier} \PY{o+ow}{in} \PY{n}{current\PYZus{}room}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{room} \PY{o}{=} \PY{n}{current\PYZus{}room}

        \PY{c}{\PYZsh{} Restrict drops to tiles right next to the player.}
        \PY{c}{\PYZsh{}}
        \PY{n}{player\PYZus{}location} \PY{o}{=} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{event}\PY{o}{.}\PY{n}{identifier}\PY{p}{]}

        \PY{n}{surrounding\PYZus{}positions} \PY{o}{=} \PY{n}{fabula}\PY{o}{.}\PY{n}{surrounding\PYZus{}positions}\PY{p}{(}\PY{n}{player\PYZus{}location}\PY{p}{)}

        \PY{c}{\PYZsh{} Include own position to allow drop on self}
        \PY{c}{\PYZsh{}}
        \PY{n}{surrounding\PYZus{}positions} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{player\PYZus{}location}\PY{p}{]}

        \PY{c}{\PYZsh{} Server.process\PYZus{}TriesToDropEvent() has already done some checks,}
        \PY{c}{\PYZsh{} so we can be sure that target\PYZus{}identifier is either a valid}
        \PY{c}{\PYZsh{} coordinate tuple or an instance of fabula.Entity.}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{target }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ is an entity identifier}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{)}\PY{p}{)}

            \PY{k}{if} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{]} \PY{o+ow}{in} \PY{n}{surrounding\PYZus{}positions}\PY{p}{:}

                \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ dropped on Entity }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{,}\PY{l+s}{\PYZdq{}}
                                   \PY{l+s}{\PYZdq{}}\PY{l+s}{ forwarding to respond()}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{item\PYZus{}identifier}\PY{p}{,}
                                                                     \PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{)}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{respond}\PY{p}{(}\PY{n}{event}\PY{p}{)}

            \PY{k}{else}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{AttemptFailedEvent}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{identifier}\PY{p}{)}\PY{p}{)}

                \PY{n}{msg} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{AttemptFailed: drop of }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ on }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ at \PYZob{}\PYZcb{} not next to player: \PYZob{}\PYZcb{}, nor in rack}\PY{l+s}{\PYZdq{}}

                \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{n}{msg}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{item\PYZus{}identifier}\PY{p}{,}
                                              \PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{,}
                                              \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{]}\PY{p}{,}
                                              \PY{n}{surrounding\PYZus{}positions}\PY{p}{)}\PY{p}{)}

        \PY{k}{elif} \PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{owner\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ dropped on Entity in rack }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{,}\PY{l+s}{\PYZdq{}}
                               \PY{l+s}{\PYZdq{}}\PY{l+s}{forwarding to respond()}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{item\PYZus{}identifier}\PY{p}{,}
                                                                \PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{)}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{respond}\PY{p}{(}\PY{n}{event}\PY{p}{)}

        \PY{k}{else}\PY{p}{:}
            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{target }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ is not an entity identifier}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{message\PYZus{}for\PYZus{}host}\PY{o}{.}\PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}
                                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{Das möchte ich hier nicht ablegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{PerceptionEvent: drop of }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ on }\PY{l+s}{\PYZdq{}}
                               \PY{l+s}{\PYZdq{}}\PY{l+s}{position \PYZob{}\PYZcb{} is not desired}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{event}\PY{o}{.}\PY{n}{item\PYZus{}identifier}\PY{p}{,}
                                                                   \PY{n}{event}\PY{o}{.}\PY{n}{target\PYZus{}identifier}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}

        \PY{k}{return}

    \PY{k}{def} \PY{n+nf}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n+nb}{id}\PY{p}{,} \PY{n}{sentence}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Auxiliary method to remove a sentence from clients sentences collection in a save way.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{k}{if} \PY{n+nb}{id} \PY{o}{==} \PY{n}{ID\PYZus{}KUNI}\PY{p}{:}

            \PY{k}{if} \PY{n}{sentence} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}kuni}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}kuni}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}

        \PY{k}{elif} \PY{n+nb}{id} \PY{o}{==} \PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{:}

            \PY{k}{if} \PY{n}{sentence} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}cassandra}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}cassandra}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}

        \PY{k}{return}

    \PY{k}{def} \PY{n+nf}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n+nb}{id}\PY{p}{,} \PY{n}{sentence}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Auxiliary method to append a sentence on clients sentences collection only if sentences does not already exists.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{k}{if} \PY{n+nb}{id} \PY{o}{==} \PY{n}{ID\PYZus{}KUNI}\PY{p}{:}

            \PY{k}{if} \PY{n}{sentence} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}kuni}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}kuni}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}

        \PY{k}{elif} \PY{n+nb}{id} \PY{o}{==} \PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{:}

            \PY{k}{if} \PY{n}{sentence} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}cassandra}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sentences\PYZus{}cassandra}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}

        \PY{k}{return}

    \PY{k}{def} \PY{n+nf}{\PYZus{}respond\PYZus{}room\PYZus{}default}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Handles game logic for default room.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{messages} \PY{o}{=} \PY{p}{[}\PY{p}{]}

        \PY{c}{\PYZsh{} identifier ID\PYZus{}KUNI}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                     \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Es muss irgendwo einen Eingang zum alten Gnomenweg geben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Mit wem habe ich die Ehre?}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Brücke, die über den Fluss in Richtung Zauberwald führt, ist kaputt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Sehr erfreut!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Wer bist du?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich suche den Weg zum Zauberwald!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin auf einer Reise, die mich durch den Zauberwald führt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich suche den Weg zum Zauberwald!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich ebenfalls.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Es muss irgendwo einen Eingang zum alten Gnomenweg geben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht finden wir ja den Eingang!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Brücke, die über den Fluss in Richtung Zauberwald führt, ist kaputt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hm \PYZhy{} kannst du nicht über den Fluss fliegen? Du bist doch eine Fee.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Mein Flügel muss geklebt werden }\PY{l+s}{\PYZsq{}}
                                                               \PY{l+s}{\PYZsq{}}\PY{l+s}{dann könnte ich wieder fliegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hm \PYZhy{} könntest du mich mitnehmen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Leider können meine Flügel kaum mein eigenes Gewicht tragen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Tür zum Gnomenweg ist offen! Da gehts zum Zauberwald lang!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Mein Flügel muss geklebt werden dann könnte ich über den Fluss fliegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich pass da nicht durch}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Dann flieg doch beim Schild über den Fluss.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Deine Flügel sind ganz, du kannst wieder fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Tausend Dank!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                           \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht kann ich sie weglocken!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToMoveEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh ein einzelner Spinnweben}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToPickUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                   \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich hab den Eingang zum Gnomenweg gefunden! Aber er ist verschlossen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht liegt der Schlüssel hier rum?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich hab den Eingang zum Gnomenweg gefunden! Aber er ist verschlossen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht liegt der Schlüssel hier irgendwo rum?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Auf dem Schild an der Brücke steht Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Mit reparierten Flügeln kann ich da also rüber fliegen}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht kann ich damit meinen Flügel kleben?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Rück mal ein Stück!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Raaar! schirr!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Öhm nichts für ungut, ich komm später wieder!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Öhm, kannst du mal beiseite treten?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Raaar! Ich beiß dich gleich!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ähm, ich geh dann mal!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Geh mir aus dem Weg!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Du wärst ein guter Happen für zwischendurch!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Mit der Spinne ist wohl nicht gut Kirschen essen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for target spider}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Woah, das ist aber eine große Spinne!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToTalkToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{CanSpeakEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{sentences}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Öhm, kannst du mal beiseite treten?}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{Rück mal ein Stück!}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{Geh mir aus dem Weg!}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for target door}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Es muss irgendwo einen Eingang zum alten Gnomenweg geben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich hab den Eingang zum Gnomenweg gefunden! Aber er ist verschlossen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Das müsste die Tür zum Gnomenweg sein! }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Mist, sie ist verschlossen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for target key}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein goldener, kleiner alter Schlüssel.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToPickUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich hab einen Schlüssel gefunden!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich glaube, ich hab den Eingang zum Gnomenweg gefunden.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich hab den Eingang zum Gnomenweg gefunden! Aber er ist verschlossen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Tür zum Gnomenweg ist offen! Da gehts zum Zauberwald lang!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Eingang zum Gnomenweg ist offen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{1x1\PYZhy{}empty.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                       \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                           \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                   \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra hat den Schlüssel gesehen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                   \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni hat einen Schlüssel.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Warum sollte ich der fiesen Spinne den Schlüssel zurückgeben?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Wo soll ich da den Schlüssel reinstecken?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hm, das macht keinen Sinn.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Abflugsort ist schon offen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for target cobweb}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein klebriger Spinnenweb, könnte nützlich sein.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToPickUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hey, die Spinne geht weg!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{process\PYZus{}TriesToMoveEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToMoveEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{)}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Warum soll ich mir denn meinen eigenen Weg zu kleben?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Laut dem Schild an der Brücke ist das Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Auf dem Schild an der Brücke steht Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr feinen klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Deine Flügel sind ganz, du kannst wieder fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Deine Flügel sind wieder ganz, du kannst wieder fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{process\PYZus{}TriesToMoveEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToMoveEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                      \PY{n}{arget\PYZus{}identifier}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{1x1\PYZhy{}empty.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ihh, sind die klebrig \PYZhy{} damit könnte man bestimmt gut Dinge kleben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ganz schön klebrig, }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{vielleicht kann ich es besser woanders benutzen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich möchte den Spinnweb nicht an das Schild kleben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Warum soll ich Spinnweben an diese Tür kleben? }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Davon geht sie ja doch nicht auf.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Schlüssel muss nicht geklebt werden.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for target door\PYZus{}unlocked}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hier gehts für mich weiter Richtung Zauberwald.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for target sign}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Auf dem Schild an der Brücke steht Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Brücke gesperrt! Betreten verboten, Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for bridge}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Abflugsort über die Brücke. Leider kann ich nicht fliegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} identifier ID\PYZus{}CASSANDRA}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin auf einer Reise, die mich durch den Zauberwald führt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Wer bist du?}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich suche den Weg zum Zauberwald!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Angenehm!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Mit wem habe ich die Ehre?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Mit wem habe ich die Ehre?}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Brücke, die über den Fluss in Richtung Zauberwald führt, ist kaputt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Es muss irgendwo einen Eingang zum alten Gnomenweg geben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin auf einer Reise, die mich durch den Zauberwald führt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich auch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr feinen klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht kannst du damit deinen Flügel kleben?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Meine Flügel sind wieder heil, ich kann fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Juhu!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Tür zum Gnomenweg ist offen! Aber da pass ich nicht durch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Dann flieg doch beim Schild über den Fluss.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich glaube, ich hab den Eingang zum Gnomenweg gefunden.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich wusste doch, dass der hier irgendwo sein muss!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Laut dem Schild an der Brücke ist das Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Könnt ich fliegen würd ich da so oder so über den Fluss fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Entschuldigung, könntest du mal einen Schritt zur Seite gehen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Rrrrrr! Ckkck!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh, Entschuldigung ich wollte nicht stören!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Könntest du mich bitte mal vorbei lassen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Du wärst aber eine leckere vollwertige Mahlzeit!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Schnell weg!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Würde es dir etwas ausmachen, mich mal kurz durch zu lassen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Würde es dir was ausmachen, wenn ich dich verspeise?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Schon, ich geh mal lieber!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for target spider}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Huch, das ist aber eine Riesenspinne!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToTalkToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{CanSpeakEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{sentences}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Entschuldigung, könntest du mal einen Schritt zur Seite gehen?}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{Könntest du mich bitte mal vorbei lassen?}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{Würde es dir etwas ausmachen, mich mal kurz durch zu lassen?}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for target door}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Eine kleine Tür, mit einem altem goldenen Schloss!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich glaube, ich hab den Eingang zum Gnomenweg gefunden.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

        \PY{c}{\PYZsh{} Events Cassandra for target key}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein güldener Schlüssel! Etwas alt, aber hübsch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToPickUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich fand einen güldenen Schlüssel und trage ihn bei mir.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich hab den Eingang zum Gnomenweg gefunden! Aber er ist verschlossen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich glaube, ich hab den Eingang zum Gnomenweg gefunden.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Tür zum Gnomenweg ist offen! Aber da pass ich nicht durch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Eingang zum Gnomenweg ist offen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{1x1\PYZhy{}empty.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                       \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                           \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni hat den Schlüssel gesehen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra hat einen Schlüssel.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich traue mich nicht, der Spinne den Schlüssel zurück zu geben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein Schild hat kein Schloss.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Das lass ich lieber.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Abflugsort ist schon offen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for target cobweb}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein sehr klebriger Spinnweb, }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{damit könnte man bestimmt gut etwas kleben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToPickUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hey, die Spinne bewegt sich!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr feinen klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{process\PYZus{}TriesToMoveEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToMoveEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{)}


        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin froh, dass die Tür offen ist, }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{die möchte ich nicht wieder zu kleben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Laut dem Schild an der Brücke ist das Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Auf dem Schild an der Brücke steht Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hinter der Spinne ist doch irgendwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Die Spinne verbirgt etwas!}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe einen sehr feinen klebrigen Spinnweb dabei.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Meine Flügel sind wieder heil, ich kann fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Meine Flügel sind wieder ganz, ich kann fliegen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{process\PYZus{}TriesToMoveEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToMoveEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                      \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                           \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{n+nb+bp}{False}\PY{p}{,}
                                                           \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{1x1\PYZhy{}empty.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                      \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                       \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{)}\PY{p}{:}


            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni guckt irritiert.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra kommt dir mit Spinnweben }\PY{l+s}{\PYZsq{}}
                                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{gefährlich nah.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ihh, was machst du? Das ist klebrig!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spider}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ganz schön klebrig, }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{vielleicht kann ich es besser woanders benutzen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich möchte den Spinnweb nicht an das Schild kleben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Warum soll ich Spinnweben an diese Tür kleben?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cobweb}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{key}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Schlüssel muss nicht geklebt werden.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for target door\PYZus{}unlocked}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{door\PYZus{}unlocked}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Tür ist offen, aber ich pass da nicht durch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for target sign}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{sign}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Laut dem Schild an der Brücke ist das Überfliegen erlaubt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Brücke gesperrt! Betreten verboten, Überfliegen erlaubt}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for bridge}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bridge}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Abflugsort über die Brücke.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{queue\PYZus{}messages}\PY{p}{(}\PY{o}{*}\PY{n}{messages}\PY{p}{)}

        \PY{k}{return} \PY{n}{event\PYZus{}list}

    \PY{k}{def} \PY{n+nf}{\PYZus{}respond\PYZus{}room\PYZus{}cassandra}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Handles game logic for room cassandra.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{messages} \PY{o}{=} \PY{p}{[}\PY{p}{]}

        \PY{c}{\PYZsh{} TriesToLookAtEvent}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{box}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Eine Kiste, leider lässt sie sich nicht öffnen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} TriesToPickUpEvent}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToPickUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Ich habe eine Laute. Leider ist sie kaputt.}\PY{l+s}{\PYZdq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht findet sich noch etwas um die Laute zu reparieren.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToPickUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Willst du ein Stück Kuchen?}\PY{l+s}{\PYZdq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich pack das Kuchenstück doch mal lieber ein, }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{für die lange Reise.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Das Kuchenstück enthält schon genug Eisen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin doch auf Diät!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Mit Lebensmitteln spielt man nicht!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Das möchte ich hier nicht ablegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{box}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Die Kiste ist aufgebrochen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                           \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{box}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                         \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                         \PY{n+nb+bp}{True}\PY{p}{,}
                                                         \PY{n+nb+bp}{True}\PY{p}{,}
                                                         \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                    \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                    \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                     \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{box}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{box}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for teleport entry}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hier geht es weiter Richtung Zauberwald.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Cassandra for teleport\PYZus{}default}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hier geht es zurück auf die andere Seite des Flusses.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{queue\PYZus{}messages}\PY{p}{(}\PY{o}{*}\PY{n}{messages}\PY{p}{)}

        \PY{k}{return} \PY{n}{event\PYZus{}list}

    \PY{k}{def} \PY{n+nf}{\PYZus{}respond\PYZus{}room\PYZus{}kuni}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Handles game logic for room kuni.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{messages} \PY{o}{=} \PY{p}{[}\PY{p}{]}

        \PY{k}{if} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein Harfe\PYZhy{}spielender Elf. }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Der sieht ein bisschen unglücklich aus.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Was soll ich mit einem leeren Kelch?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hach, ich habs doch schon schwer genug.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Das möchte ich hier nicht ablegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                             \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                             \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh du bist so gut zu mir, dafür schenke ich dir diese Saite!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                         \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                                         \PY{n+nb+bp}{True}\PY{p}{,}
                                                                         \PY{n+nb+bp}{True}\PY{p}{,}
                                                                         \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                    \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                    \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                     \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                           \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ähm...vielen Dank!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PicksUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                             \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}append\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Saite von einer Harfe.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

        \PY{c}{\PYZsh{} Events Kuni for teleport entry}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}entry}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hier geht es weiter Richtung Zauberwald.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Events Kuni for teleport\PYZus{}default}
        \PY{c}{\PYZsh{}}
        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}default}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hier geht es zurück auf den Gnomenweg.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToTalkToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                 \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ Was machst du hier?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich hab Harfe\PYZhy{}Spielen\PYZhy{}Schicht und das noch fünf Stunden lang.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{elf}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Dabei bin ich sooo durstig!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} WOULD BE NICE: silly conversation between Kuni and elf}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{queue\PYZus{}messages}\PY{p}{(}\PY{o}{*}\PY{n}{messages}\PY{p}{)}

        \PY{k}{return} \PY{n}{event\PYZus{}list}

    \PY{k}{def} \PY{n+nf}{\PYZus{}respond\PYZus{}room\PYZus{}entry}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{event}\PY{p}{,} \PY{n}{room}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Handles game logic for room entry.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{messages} \PY{o}{=} \PY{p}{[}\PY{p}{]}

        \PY{k}{if} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hier gehts zurück, wo ich hergekommen bin!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Weg für Gnome verboten!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Dieser Weg führt zurück zum Fluss.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Dieser Weg ist nur für sehr kleine Wesen gemacht.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToTalkToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hey. Kannst du mich mal durch lassen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{Wenn du 5 Goldtaler locker machen kannst.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{5 Taler? Das sind ja Preise!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{Wenn du nicht zahlen kannst, kommst du auch nicht durch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToTalkToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin Cassandra die Fee und würde gerne durch den Zauberwald reisen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{Wegezoll auch für Feen! 5 Goldtaler bitte.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe leider kein Gold.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{Tja, dann darfst du nicht passieren.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Mit wem habe ich die Ehre?}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Sehr erfreut!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Wer bist du?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Guten Tag, ich bin die Fee Cassandra.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Wer bist du?}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Angenehm!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Mit wem habe ich die Ehre?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Mit wem habe ich die Ehre?}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Hallo, ich bin der Gnom Kuni.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich suche den Weg zum Zauberwald!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich ebenfalls.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin auf einer Reise, die mich durch den Zauberwald führt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich auch.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Willst du ein Stück Kuchen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Nein Danke!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                        \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Saite von einer Harfe.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{and} \PY{o+ow}{not} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht kann man die noch gebrauchen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{k}{else}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe ein Laute ohne Saiten. }\PY{l+s}{\PYZsq{}}
                                                     \PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht können wir sie damit reparieren.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired} \PY{o}{=} \PY{n+nb+bp}{True}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Laute. Leider ist sie kaputt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe ein Laute ohne Saiten. }\PY{l+s}{\PYZsq{}}
                                                     \PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht können wir sie damit reparieren.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}


                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                         \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Es hat funktioniert! }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{Jetzt haben wir eine spielbare Laute.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PicksUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                 \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni hat die Laute eingesteckt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                       \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Laute. Leider ist sie kaputt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{and} \PY{o+ow}{not} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Vielleicht kann man die noch reparieren.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{k}{else}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired} \PY{o}{=} \PY{n+nb+bp}{True}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{event}\PY{o}{.}\PY{n}{text}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Saite von einer Harfe.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe ein Harfensaite. Vielleicht können wir sie damit reparieren}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                         \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Es hat funktioniert! }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{Jetzt haben wir eine spielbare Laute.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PicksUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                 \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra hat die Laute eingesteckt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}


        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}
              \PY{o+ow}{and} \PY{o+ow}{not} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich besitze nichts, womit man die kaputte Laute reparieren könnte.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
            \PY{k}{else}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired} \PY{o}{=} \PY{n+nb+bp}{True}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Laute. Leider ist sie kaputt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Saite von einer Harfe.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni nimmt die kaputte Laute.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra gibt dir eine kaputte Laute.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Moment mal, ich hab da eine Idee!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                         \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}KUNI}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Es hat funktioniert! Zusammen ergeben Harfensaite }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{und kaputte Laute ein spielbares Instrument.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PicksUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                 \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni hat die Laute eingesteckt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}
              \PY{o+ow}{and} \PY{o+ow}{not} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich besitze nichts, wofür man eine Saite gebrauchen könnte.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
            \PY{k}{else}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{lute\PYZus{}is\PYZus{}repaired} \PY{o}{=} \PY{n+nb+bp}{True}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Laute. Leider ist sie kaputt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ich habe eine Saite von einer Harfe.}\PY{l+s}{\PYZsq{}}\PY{p}{)}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,} \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra nimmt die Seite der Harfe.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni gibt dir die Saite einer Harfe.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Moment mal, ich hab da eine Idee!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{Entity}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{n}{fabula}\PY{o}{.}\PY{n}{ITEM}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{n+nb+bp}{True}\PY{p}{,}
                                                                             \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{image/png}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.png}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{audio/ogg}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                        \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{,}
                                                                              \PY{l+s}{\PYZsq{}}\PY{l+s}{text/plain}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{n}{fabula}\PY{o}{.}\PY{n}{Asset}\PY{p}{(}\PY{n}{uri}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute.txt}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                                                         \PY{n}{data}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{]} \PY{o}{+} \PY{p}{(}\PY{n}{room}\PY{o}{.}\PY{n}{identifier}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Es hat funktioniert jetzt haben wir eine }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{spielbare Laute.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PicksUpEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                 \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra hat die Laute eingesteckt.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ein ziemlich großer, grobschlächtiger Kerl, }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{der den Eingang zum Zauberwald bewacht.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToLookAtEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Der Eingang zum Zauberwald wird von einem Wächter }\PY{l+s}{\PYZsq{}}
                                                             \PY{l+s}{\PYZsq{}}\PY{l+s}{bewacht, der sieht ganz schön ungemütlich aus.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Du reichst Kuni das Kuchenstück.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra will dir ein Stück Kuchen geben.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Nein Danke Cassandra, ich mag nicht so viel Kuchen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich bin doch auf Diät!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}remove\PYZus{}sentence}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Willst du ein Stück Kuchen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                 \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}

                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ach das ist ja nett! Ich teile den Kuchen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Mampf, mampf...}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Wisst ihr, ich war ja nicht immer Wächter des Waldweges.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich war leidenschaftlicher Minnesänger.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh wirklich?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ja! Und dann haben mich Räuber überfallen, mir alles Gold }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{abgeknüpft und meine Laute geklaut!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh nein, das tut mir aber leid!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Lässt du uns jetzt durch?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Nein, meine Aufgabe ist es den Weg zu bewachen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Auch wenn ich mich sofort auf und davon machen würde, wenn }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{ich wieder eine Laute hätte.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{k}{else}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh lecker, aber das können wir nicht zu zweit essen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Was fang ich damit nur an?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Was soll ich mit einer Saite ohne Klangkörper?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Was fang ich damit nur an?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                            \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Was soll ich mit einem Klangkörper ohne Saite?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni schüttelt den Kopf.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra möchte dir die Laute überreichen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ach, trag du die ruhig mal.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra schüttelt den Kopf.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

            \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni möchte dir die }\PY{l+s}{\PYZsq{}}
                                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{Laute überreichen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                          \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ich kann leider keine Saiteninstrumente spielen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{pry}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{cake}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute\PYZus{}broken}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Das möchte ich hier nicht ablegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{goblet\PYZus{}filled}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{dew}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}cassandra}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{o+ow}{or} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{string\PYZus{}harp}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                  \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{teleport\PYZus{}room\PYZus{}kuni}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                  \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Das möchte ich hier nicht ablegen.}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{p}{(}\PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                               \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                               \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{n}{ID\PYZus{}KUNI} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh ihr seid die besten, ich kann endlich wieder muszierend umherziehen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

                \PY{c}{\PYZsh{} The guardian runs off to find his luck in music making}
                \PY{c}{\PYZsh{}}
                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{MovesToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                 \PY{n}{location}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{MovesToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                 \PY{n}{location}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Juhu der Weg ist frei!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                             \PY{n}{fabula}\PY{o}{.}\PY{n}{MovesToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                 \PY{n}{location}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Wollen wir dann gemeinsam weiter ziehen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Sehr gerne! Das hat ja bisher }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{auch ausgezeichnet geklappt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ENDE...}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ENDE...}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{k}{else}\PY{p}{:} \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                        \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Kuni möchte das bestimmt mit erleben...}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{k}{elif} \PY{n}{event} \PY{o}{==} \PY{n}{fabula}\PY{o}{.}\PY{n}{TriesToDropEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                              \PY{n}{item\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                              \PY{n}{target\PYZus{}identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}

            \PY{k}{if} \PY{n}{ID\PYZus{}CASSANDRA} \PY{o+ow}{in} \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

                \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Oh ihr seid die besten, ich kann endlich wieder muszierend umherziehen!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

                \PY{c}{\PYZsh{} The guardian runs off to find his luck in music making}
                \PY{c}{\PYZsh{}}
                \PY{n}{messages} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DropsEvent}\PY{p}{(}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                               \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{rack}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                               \PY{n}{room}\PY{o}{.}\PY{n}{entity\PYZus{}locations}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{lute}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{MovesToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                 \PY{n}{location}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{MovesToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                 \PY{n}{location}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Juhu der Weg ist frei!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                             \PY{n}{fabula}\PY{o}{.}\PY{n}{MovesToEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                                 \PY{n}{location}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{DeleteEvent}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{guardian}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Wollen wir dann gemeinsam weiter ziehen?}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{SaysEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                              \PY{n}{text}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Sehr gerne! Das hat ja bisher auch ausgezeichnet }\PY{l+s}{\PYZsq{}}
                                                                   \PY{l+s}{\PYZsq{}}\PY{l+s}{geklappt!}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ENDE...}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                             \PY{n}{fabula}\PY{o}{.}\PY{n}{Message}\PY{p}{(}\PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}CASSANDRA}\PY{p}{,}
                                                                    \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{ENDE...}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}

            \PY{k}{else}\PY{p}{:} \PY{n}{event\PYZus{}list} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{PerceptionEvent}\PY{p}{(}\PY{n}{identifier}\PY{o}{=}\PY{n}{ID\PYZus{}KUNI}\PY{p}{,}
                                                        \PY{n}{perception}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Cassandra möchte bestimmt dabei sein...}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{queue\PYZus{}messages}\PY{p}{(}\PY{o}{*}\PY{n}{messages}\PY{p}{)}

        \PY{k}{return} \PY{n}{event\PYZus{}list}

    \PY{k}{def} \PY{n+nf}{\PYZus{}load\PYZus{}room}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{client\PYZus{}id}\PY{p}{,} \PY{n}{room\PYZus{}name}\PY{p}{,} \PY{n}{location}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Load room for client with client\PYZus{}id corresponding to room\PYZus{}name.}

\PY{l+s+sd}{           location is a (x, y) tuple of where to spawn the Entity when the room}
\PY{l+s+sd}{           already exists.}

\PY{l+s+sd}{           Returns a list of events establishing the according room.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{c}{\PYZsh{} Add EnterRoomEvent in front}
        \PY{c}{\PYZsh{}}
        \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{n}{fabula}\PY{o}{.}\PY{n}{EnterRoomEvent}\PY{p}{(}\PY{n}{client\PYZus{}id}\PY{p}{,} \PY{n}{room\PYZus{}name}\PY{p}{)}\PY{p}{]}

        \PY{c}{\PYZsh{} Does the room already exist?}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{n}{room\PYZus{}name} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}id}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Sending existing room}\PY{l+s}{\PYZdq{}}\PY{p}{)}

            \PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{\PYZus{}generate\PYZus{}room\PYZus{}rack\PYZus{}events}\PY{p}{(}\PY{n}{room\PYZus{}name}\PY{p}{)}\PY{p}{)}

            \PY{c}{\PYZsh{} In that case, we have to spawn the Entity manually.}

            \PY{c}{\PYZsh{} The Entity should still exist while we\PYZsq{}re here.}
            \PY{c}{\PYZsh{}}
            \PY{n}{entity} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{host}\PY{o}{.}\PY{n}{room\PYZus{}by\PYZus{}client}\PY{p}{[}\PY{n}{client\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{entity\PYZus{}dict}\PY{p}{[}\PY{n}{client\PYZus{}id}\PY{p}{]}

            \PY{n}{location} \PY{o}{=} \PY{n}{location} \PY{o}{+} \PY{p}{(}\PY{n}{room\PYZus{}name}\PY{p}{,}\PY{p}{)}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Spawning }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{ at }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{client\PYZus{}id}\PY{p}{,} \PY{n}{location}\PY{p}{)}\PY{p}{)}

            \PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{SpawnEvent}\PY{p}{(}\PY{n}{entity}\PY{p}{,} \PY{n}{location}\PY{p}{)}\PY{p}{)}

        \PY{k}{else}\PY{p}{:}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Room does not yet exist, attempting to load from file}\PY{l+s}{\PYZdq{}}\PY{p}{)}

            \PY{n}{roomfile\PYZus{}name} \PY{o}{=} \PY{n}{room\PYZus{}name} \PY{o}{+} \PY{l+s}{\PYZdq{}}\PY{l+s}{.floorplan}\PY{l+s}{\PYZdq{}}

            \PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{serverside}\PY{o}{.}\PY{n}{load\PYZus{}room\PYZus{}from\PYZus{}file}\PY{p}{(}\PY{n}{roomfile\PYZus{}name}\PY{p}{,}
                                                                            \PY{n}{complete}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}\PY{p}{)}

            \PY{c}{\PYZsh{} Has anything been added?}
            \PY{c}{\PYZsh{}}
            \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{event\PYZus{}list}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}

                \PY{c}{\PYZsh{} TODO: jump back to the level selection screen / room}
                \PY{c}{\PYZsh{}}
                \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{critical}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{error opening file }\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZob{}\PYZcb{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{roomfile\PYZus{}name}\PY{p}{)}\PY{p}{)}

                \PY{c}{\PYZsh{} TODO: exit properly}
                \PY{c}{\PYZsh{}}
                \PY{k}{raise} \PY{n+ne}{SystemExit}

            \PY{c}{\PYZsh{} Remove all players that do not match client id}
            \PY{c}{\PYZsh{}}
            \PY{n}{event\PYZus{}list} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}filter\PYZus{}spawn\PYZus{}events}\PY{p}{(}\PY{n}{event\PYZus{}list}\PY{p}{,} \PY{n}{client\PYZus{}id}\PY{p}{)}

        \PY{c}{\PYZsh{} All events there, by one way or another.}
        \PY{c}{\PYZsh{}}
        \PY{n}{event\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{RoomCompleteEvent}\PY{p}{(}\PY{p}{)}\PY{p}{)}

        \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Room loaded.}\PY{l+s}{\PYZdq{}}\PY{p}{)}

        \PY{k}{return} \PY{n}{event\PYZus{}list}

\PY{k}{class} \PY{n+nc}{ZWPygameUI}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{pygameui}\PY{o}{.}\PY{n}{PygameUserInterface}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}A subclass of the default Pygame User Interface to implement custom behavior.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}

    \PY{k}{def} \PY{n+nf}{get\PYZus{}connection\PYZus{}details}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{prompt\PYZus{}connector}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Copied from pygameui.get\PYZus{}connection\PYZus{}deatils and modified to display two buttons to start game as kuni or cassandra.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{called}\PY{l+s}{\PYZdq{}}\PY{p}{)}

        \PY{c}{\PYZsh{} Display the splash screen}
        \PY{c}{\PYZsh{}}
        \PY{k}{try}\PY{p}{:}
            \PY{n+nb}{file} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{assets}\PY{o}{.}\PY{n}{fetch}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{splash.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}

            \PY{n}{surface} \PY{o}{=} \PY{n}{pygame}\PY{o}{.}\PY{n}{image}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{file}\PY{p}{)}

            \PY{n+nb}{file}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}

            \PY{c}{\PYZsh{} Convert to internal format suitable for blitting.}
            \PY{c}{\PYZsh{} Not using convert\PYZus{}alpha(), no RGBA support for splash.}
            \PY{c}{\PYZsh{}}
            \PY{n}{surface} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{convert}\PY{p}{(}\PY{p}{)}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{displaying splash.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{window}\PY{o}{.}\PY{n}{image} \PY{o}{=} \PY{n}{surface}

        \PY{k}{except}\PY{p}{:}
            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{warning}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{splash.png not found, not displaying splash screen}\PY{l+s}{\PYZdq{}}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{display\PYZus{}single\PYZus{}frame}\PY{p}{(}\PY{p}{)}

        \PY{c}{\PYZsh{} Use a container so we can access it from an ad\PYZhy{}hoc function.}
        \PY{c}{\PYZsh{} That\PYZsq{}s Python.}
        \PY{c}{\PYZsh{}}
        \PY{n}{container\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s}{\PYZdq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZdq{}} \PY{p}{:} \PY{n+nb+bp}{None}\PY{p}{,}
                          \PY{l+s}{\PYZdq{}}\PY{l+s}{connector}\PY{l+s}{\PYZdq{}} \PY{p}{:} \PY{n+nb+bp}{None}\PY{p}{\PYZcb{}}

        \PY{k}{def} \PY{n+nf}{login}\PY{p}{(}\PY{n}{buttonplane}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} Construct tuple with default IP}
            \PY{c}{\PYZsh{}}
            \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{connector}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{127.0.0.1}\PY{l+s}{\PYZdq{}}

            \PY{n}{buttonplane}\PY{o}{.}\PY{n}{parent}\PY{o}{.}\PY{n}{destroy}\PY{p}{(}\PY{p}{)}

            \PY{k}{return}

        \PY{k}{def} \PY{n+nf}{login\PYZus{}kuni\PYZus{}callback}\PY{p}{(}\PY{n}{buttonplane}\PY{p}{)}\PY{p}{:}

            \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{ID\PYZus{}KUNI}

            \PY{n}{login}\PY{p}{(}\PY{n}{buttonplane}\PY{p}{)}

        \PY{k}{def} \PY{n+nf}{login\PYZus{}cassandra\PYZus{}callback}\PY{p}{(}\PY{n}{buttonplane}\PY{p}{)}\PY{p}{:}

            \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{ID\PYZus{}CASSANDRA}

            \PY{n}{login}\PY{p}{(}\PY{n}{buttonplane}\PY{p}{)}

        \PY{n}{container} \PY{o}{=} \PY{n}{PLANES}\PY{o}{.}\PY{n}{gui}\PY{o}{.}\PY{n}{tmb}\PY{o}{.}\PY{n}{TMBContainer}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{get\PYZus{}connection\PYZus{}details}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                \PY{n}{PLANES}\PY{o}{.}\PY{n}{gui}\PY{o}{.}\PY{n}{tmb}\PY{o}{.}\PY{n}{C\PYZus{}256\PYZus{}STYLE}\PY{p}{,}
                                                \PY{n}{padding}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}

        \PY{c}{\PYZsh{} Login buttons (label, width, callback[, style])}
        \PY{c}{\PYZsh{}}
        \PY{n}{button\PYZus{}cassandra} \PY{o}{=} \PY{n}{PLANES}\PY{o}{.}\PY{n}{gui}\PY{o}{.}\PY{n}{lmr}\PY{o}{.}\PY{n}{LMRButton}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Als Fee Cassandra spielen}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                                    \PY{l+m+mi}{150}\PY{p}{,}
                                                    \PY{n}{login\PYZus{}cassandra\PYZus{}callback}\PY{p}{)}
        \PY{n}{container}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{button\PYZus{}cassandra}\PY{p}{)}

        \PY{n}{button\PYZus{}kuni} \PY{o}{=} \PY{n}{PLANES}\PY{o}{.}\PY{n}{gui}\PY{o}{.}\PY{n}{lmr}\PY{o}{.}\PY{n}{LMRButton}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Als Gnom Kuni spielen}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                               \PY{l+m+mi}{150}\PY{p}{,}
                                               \PY{n}{login\PYZus{}kuni\PYZus{}callback}\PY{p}{)}
        \PY{n}{container}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{button\PYZus{}kuni}\PY{p}{)}

        \PY{c}{\PYZsh{} Optional connector prompt}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{n}{prompt\PYZus{}connector}\PY{p}{:}

            \PY{n}{container}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{PLANES}\PY{o}{.}\PY{n}{gui}\PY{o}{.}\PY{n}{Label}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{connector\PYZus{}caption}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                           \PY{l+s}{\PYZdq{}}\PY{l+s}{Server IP}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                           \PY{n}{pygame}\PY{o}{.}\PY{n}{Rect}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}
                                                       \PY{p}{(}\PY{l+m+mi}{150}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                           \PY{n}{background\PYZus{}color}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,} \PY{l+m+mi}{128}\PY{p}{,} \PY{l+m+mi}{128}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{n}{container}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{PLANES}\PY{o}{.}\PY{n}{gui}\PY{o}{.}\PY{n}{TextBox}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{connector}\PY{l+s}{\PYZdq{}}\PY{p}{,}
                                             \PY{n}{pygame}\PY{o}{.}\PY{n}{Rect}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}
                                                         \PY{p}{(}\PY{l+m+mi}{150}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                             \PY{n}{return\PYZus{}callback}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}\PY{p}{)}

            \PY{c}{\PYZsh{} Provide a default}
            \PY{c}{\PYZsh{}}
            \PY{n}{container}\PY{o}{.}\PY{n}{connector}\PY{o}{.}\PY{n}{text} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{127.0.0.1}\PY{l+s}{\PYZdq{}}

            \PY{c}{\PYZsh{} Upon clicked, register the TextBox for keyboard input}
            \PY{c}{\PYZsh{}}
            \PY{n}{container}\PY{o}{.}\PY{n}{connector}\PY{o}{.}\PY{n}{left\PYZus{}click\PYZus{}callback} \PY{o}{=} \PY{k}{lambda} \PY{n}{plane} \PY{p}{:} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{window}\PY{o}{.}\PY{n}{key\PYZus{}sensitive}\PY{p}{(}\PY{n}{plane}\PY{p}{)}

        \PY{n}{container}\PY{o}{.}\PY{n}{rect}\PY{o}{.}\PY{n}{center} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{window}\PY{o}{.}\PY{n}{rect}\PY{o}{.}\PY{n}{center}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{window}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{container}\PY{p}{)}

        \PY{k}{while} \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o+ow}{is} \PY{n+nb+bp}{None}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{display\PYZus{}single\PYZus{}frame}\PY{p}{(}\PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{collect\PYZus{}player\PYZus{}input}\PY{p}{(}\PY{p}{)}

            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{exit\PYZus{}requested}\PY{p}{:}

                \PY{c}{\PYZsh{} Return anything to get out of the loop}
                \PY{c}{\PYZsh{}}
                \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{exit requested}\PY{l+s}{\PYZdq{}}

        \PY{c}{\PYZsh{} We are done with the splash screen if there was one. Now make sure}
        \PY{c}{\PYZsh{} that there is no image for the window Plane left that would invisibly}
        \PY{c}{\PYZsh{} be blitted below room and inventory planes.}
        \PY{c}{\PYZsh{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{window}\PY{o}{.}\PY{n}{image} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{window}\PY{o}{.}\PY{n}{display}

        \PY{c}{\PYZsh{} Return connector (ip, port) using the default Fabula}
        \PY{c}{\PYZsh{} port 0xfab == 4011.}
        \PY{c}{\PYZsh{}}
        \PY{k}{return} \PY{p}{(}\PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
                \PY{p}{(}\PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{connector}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4011}\PY{p}{)}\PY{p}{)}

\PY{k}{class} \PY{n+nc}{ZWAudioUI}\PY{p}{(}\PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{audioui}\PY{o}{.}\PY{n}{AudioUserInterface}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}A subclass of the default AudioUserInterface to implement custom behavior.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}

    \PY{n}{VOICE\PYZus{}SPECIFICATIONS} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{b}\PY{l+s}{\PYZsq{}}\PY{l+s}{german}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                            \PY{n+nb}{str}\PY{p}{(}\PY{n}{b}\PY{l+s}{\PYZsq{}}\PY{l+s}{German}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                            \PY{n+nb}{str}\PY{p}{(}\PY{n}{b}\PY{l+s}{\PYZsq{}}\PY{l+s}{de}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                            \PY{n+nb}{str}\PY{p}{(}\PY{n}{b}\PY{l+s}{\PYZsq{}}\PY{l+s}{De}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                            \PY{n+nb}{str}\PY{p}{(}\PY{n}{b}\PY{l+s}{\PYZsq{}}\PY{l+s}{DE}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                            \PY{l+s}{\PYZsq{}}\PY{l+s}{german}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                            \PY{l+s}{\PYZsq{}}\PY{l+s}{German}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                            \PY{l+s}{\PYZsq{}}\PY{l+s}{de}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                            \PY{l+s}{\PYZsq{}}\PY{l+s}{De}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                            \PY{l+s}{\PYZsq{}}\PY{l+s}{DE}\PY{l+s}{\PYZsq{}}\PY{p}{]}

    \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{assets}\PY{p}{,} \PY{n}{framerate}\PY{p}{,} \PY{n}{host}\PY{p}{)}\PY{p}{:}

        \PY{c}{\PYZsh{} Call base class}
        \PY{c}{\PYZsh{}}
        \PY{n}{fabula}\PY{o}{.}\PY{n}{plugins}\PY{o}{.}\PY{n}{audioui}\PY{o}{.}\PY{n}{AudioUserInterface}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{assets}\PY{p}{,} \PY{n}{framerate}\PY{p}{,} \PY{n}{host}\PY{p}{)}

        \PY{c}{\PYZsh{} Set speech rate of TTS}
        \PY{c}{\PYZsh{}}
        \PY{n}{rate} \PY{o}{=} \PY{l+m+mi}{100}
        \PY{k}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}(): rate == \PYZob{}\PYZcb{}}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{rate}\PY{p}{)}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{setProperty}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{rate}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{rate}\PY{p}{)}

        \PY{c}{\PYZsh{} Overwrite english default passive event messages}
        \PY{c}{\PYZsh{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{in\PYZus{}inventory\PYZus{}msg} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZob{}\PYZcb{} ins Inventar aufgenommen}\PY{l+s}{\PYZdq{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{taker\PYZus{}in\PYZus{}room\PYZus{}msg} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZob{}\PYZcb{} ist im Raum}\PY{l+s}{\PYZdq{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{taker\PYZus{}left\PYZus{}room\PYZus{}msg} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZob{}\PYZcb{} hat den Raum verlassen}\PY{l+s}{\PYZdq{}}

        \PY{k}{return}

    \PY{k}{def} \PY{n+nf}{get\PYZus{}connection\PYZus{}details}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{prompt\PYZus{}connector}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Read out an introductory text and make an AudioMenuList as main Menu.}
\PY{l+s+sd}{           On the main menu the player can choose to start game as kuni or}
\PY{l+s+sd}{           cassandra and enter an IP address. The default IP address is}
\PY{l+s+sd}{           127.0.0.1.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{called}\PY{l+s}{\PYZdq{}}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{connection\PYZus{}details\PYZus{}complete} \PY{o}{=} \PY{n+nb+bp}{False}

        \PY{c}{\PYZsh{} Use a container so we can access it from an ad\PYZhy{}hoc function.}
        \PY{c}{\PYZsh{} That\PYZsq{}s Python.}
        \PY{c}{\PYZsh{}}
        \PY{n}{container\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{player}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s}{\PYZsq{}}\PY{l+s}{connector}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{127.0.0.1}\PY{l+s}{\PYZsq{}}\PY{p}{\PYZcb{}}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{say}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Willkommen bei dem Abenteuerspiel Zauberwald! }\PY{l+s}{\PYZdq{}}
                            \PY{l+s}{\PYZdq{}}\PY{l+s}{Wähle mit den Pfeiltasten hoch und runter aus, ob du die Fee Cassandra oder }\PY{l+s}{\PYZdq{}}
                            \PY{l+s}{\PYZdq{}}\PY{l+s}{den Gnom Kuni spielen möchtest. Bestätige deine Auswahl mit der Pfeiltaste rechts.}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{intro}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{runAndWait}\PY{p}{(}\PY{p}{)}

        \PY{c}{\PYZsh{} Connection details menu}
        \PY{c}{\PYZsh{}}
        \PY{n}{connection\PYZus{}details\PYZus{}entries} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Als Cassandra spielen}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                      \PY{l+s}{\PYZsq{}}\PY{l+s}{Als Kuni spielen}\PY{l+s}{\PYZsq{}}\PY{p}{]}

        \PY{c}{\PYZsh{} Optional connector prompt}
        \PY{c}{\PYZsh{}}
        \PY{k}{if} \PY{n}{prompt\PYZus{}connector}\PY{p}{:}

            \PY{n}{connection\PYZus{}details\PYZus{}entries}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ei Pi Adresse}\PY{l+s}{\PYZsq{}}\PY{p}{)}
            \PY{n}{connection\PYZus{}details\PYZus{}entries}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Eine neue Ei Pi Adresse eingeben}\PY{l+s}{\PYZsq{}}\PY{p}{)}

            \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{connector}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{127.0.0.1}\PY{l+s}{\PYZsq{}}

            \PY{n}{audio\PYZus{}text\PYZus{}field\PYZus{}ip\PYZus{}address} \PY{o}{=} \PY{n}{AudioTextField}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Ei Pi Adresse}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                                          \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{p}{)}

        \PY{n}{connection\PYZus{}details\PYZus{}entries}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Beenden}\PY{l+s}{\PYZsq{}}\PY{p}{)}

        \PY{k}{def} \PY{n+nf}{callback\PYZus{}on\PYZus{}entry\PYZus{}selected}\PY{p}{(}\PY{n}{connection\PYZus{}details\PYZus{}menu}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Callback function for entry selected in self.connection\PYZus{}details\PYZus{}menu.}
\PY{l+s+sd}{            \PYZdq{}\PYZdq{}\PYZdq{}}

            \PY{n}{selected\PYZus{}entry} \PY{o}{=} \PY{n}{connection\PYZus{}details\PYZus{}menu}\PY{o}{.}\PY{n}{list}\PY{p}{[}\PY{n}{connection\PYZus{}details\PYZus{}menu}\PY{o}{.}\PY{n}{list\PYZus{}index}\PY{p}{]}

            \PY{n}{fabula}\PY{o}{.}\PY{n}{LOGGER}\PY{o}{.}\PY{n}{debug}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Entry selected: \PYZob{}\PYZcb{}}\PY{l+s}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{selected\PYZus{}entry}\PY{p}{)}\PY{p}{)}

            \PY{k}{if} \PY{n}{selected\PYZus{}entry} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{Als Cassandra spielen}\PY{l+s}{\PYZsq{}}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{say}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Spiel startet als Cassandra}\PY{l+s}{\PYZdq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{runAndWait}\PY{p}{(}\PY{p}{)}
                \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{cassandra}\PY{l+s}{\PYZsq{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{connection\PYZus{}details\PYZus{}complete} \PY{o}{=} \PY{n+nb+bp}{True}

            \PY{k}{elif} \PY{n}{selected\PYZus{}entry} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{Als Kuni spielen}\PY{l+s}{\PYZsq{}}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{say}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Spiel startet als Kuni}\PY{l+s}{\PYZdq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{runAndWait}\PY{p}{(}\PY{p}{)}
                \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{kuni}\PY{l+s}{\PYZsq{}}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{connection\PYZus{}details\PYZus{}complete} \PY{o}{=} \PY{n+nb+bp}{True}

            \PY{k}{elif} \PY{n}{selected\PYZus{}entry} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{Ei Pi Adresse}\PY{l+s}{\PYZsq{}}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{say}\PY{p}{(}\PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{connector}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{runAndWait}\PY{p}{(}\PY{p}{)}

            \PY{k}{elif} \PY{n}{selected\PYZus{}entry} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{Eine neue Ei Pi Adresse eingeben}\PY{l+s}{\PYZsq{}}\PY{p}{:}

                \PY{n}{audio\PYZus{}text\PYZus{}field\PYZus{}ip\PYZus{}address}\PY{o}{.}\PY{n}{focus\PYZus{}audio\PYZus{}text\PYZus{}field}\PY{p}{(}\PY{p}{)}

                \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{connector}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{audio\PYZus{}text\PYZus{}field\PYZus{}ip\PYZus{}address}\PY{o}{.}\PY{n}{process\PYZus{}key\PYZus{}input}\PY{p}{(}\PY{p}{)}

            \PY{k}{elif} \PY{n}{selected\PYZus{}entry} \PY{o}{==} \PY{l+s}{\PYZsq{}}\PY{l+s}{Beenden}\PY{l+s}{\PYZsq{}}\PY{p}{:}

                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{connection\PYZus{}details\PYZus{}complete} \PY{o}{=} \PY{n+nb+bp}{True}
                \PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{exit requested}\PY{l+s}{\PYZsq{}}

            \PY{k}{return}

        \PY{c}{\PYZsh{} Sound to be played when entering menu}
        \PY{c}{\PYZsh{}}
        \PY{n+nb}{file} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{assets}\PY{o}{.}\PY{n}{fetch}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{fabula\PYZus{}main\PYZus{}menu.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n}{main\PYZus{}menu\PYZus{}sound} \PY{o}{=} \PY{n}{pygame}\PY{o}{.}\PY{n}{mixer}\PY{o}{.}\PY{n}{Sound}\PY{p}{(}\PY{n+nb}{file}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{connection\PYZus{}details\PYZus{}menu} \PY{o}{=} \PY{n}{TextMenuList}\PY{p}{(}\PY{n}{connection\PYZus{}details\PYZus{}entries}\PY{p}{,}
                                                    \PY{n}{main\PYZus{}menu\PYZus{}sound}\PY{p}{,}
                                                    \PY{n+nb+bp}{None}\PY{p}{,}
                                                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{channel\PYZus{}system}\PY{p}{,}
                                                    \PY{n}{callback\PYZus{}on\PYZus{}entry\PYZus{}selected}\PY{p}{,}
                                                    \PY{n+nb+bp}{None}\PY{p}{,}
                                                    \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{p}{)}

        \PY{c}{\PYZsh{} Transition to connection\PYZhy{}details\PYZhy{}input\PYZhy{}state}
        \PY{c}{\PYZsh{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}push\PYZus{}input\PYZus{}state\PYZus{}on\PYZus{}stack}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{INPUT\PYZus{}STATE\PYZus{}CONNECTION\PYZus{}DETAILS}\PY{p}{)}

        \PY{k}{while} \PY{o+ow}{not} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{connection\PYZus{}details\PYZus{}complete}\PY{p}{:}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{collect\PYZus{}player\PYZus{}input}\PY{p}{(}\PY{p}{)}

        \PY{k}{return} \PY{p}{(}\PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{login\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                \PY{p}{(}\PY{n}{container\PYZus{}dict}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{connector}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4011}\PY{p}{)}\PY{p}{)}

    \PY{k}{def} \PY{n+nf}{\PYZus{}set\PYZus{}up\PYZus{}help\PYZus{}menu}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Sets up the help menu list.}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}

        \PY{c}{\PYZsh{} Help Menu for Zauberwald controls}
        \PY{c}{\PYZsh{}}
        \PY{n}{help\PYZus{}menu\PYZus{}entries\PYZus{}values} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s}{\PYZsq{}}\PY{l+s}{Taste q}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Inventar öffnen}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste e}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Interaktionsmenü öffnen}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste x}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Spielerposition vorlesen}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste y}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Liste mit allen Objekten im Raum}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Bewegung}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{w a s d Tasten}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste w}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Um ein Feld nach oben bewegen}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste a}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Um ein Feld nach links bewegen}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste s}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Um ein Feld nach unten bewegen}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste d}\PY{l+s}{\PYZsq{}} \PY{p}{:} \PY{l+s}{\PYZsq{}}\PY{l+s}{Um ein Feld nach rechts bewegen}\PY{l+s}{\PYZsq{}}\PY{p}{\PYZcb{}}

        \PY{n}{help\PYZus{}menu\PYZus{}entries} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{Taste q}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste e}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste x}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste y}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Bewegung}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste w}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste a}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste s}\PY{l+s}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s}{\PYZsq{}}\PY{l+s}{Taste d}\PY{l+s}{\PYZsq{}}\PY{p}{]}

        \PY{k}{def} \PY{n+nf}{callback\PYZus{}on\PYZus{}help\PYZus{}entry\PYZus{}selected}\PY{p}{(}\PY{n}{help\PYZus{}menu}\PY{p}{)}\PY{p}{:}

            \PY{n}{selected\PYZus{}entry} \PY{o}{=} \PY{n}{help\PYZus{}menu}\PY{o}{.}\PY{n}{list}\PY{p}{[}\PY{n}{help\PYZus{}menu}\PY{o}{.}\PY{n}{list\PYZus{}index}\PY{p}{]}

            \PY{c}{\PYZsh{} Let the TTS engine read the help information at current index}
            \PY{c}{\PYZsh{}}
            \PY{n}{help\PYZus{}menu}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{say}\PY{p}{(}\PY{n}{help\PYZus{}menu\PYZus{}entries\PYZus{}values}\PY{p}{[}\PY{n}{selected\PYZus{}entry}\PY{p}{]}\PY{p}{)}
            \PY{n}{help\PYZus{}menu}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{o}{.}\PY{n}{runAndWait}\PY{p}{(}\PY{p}{)}

            \PY{k}{return}

        \PY{k}{def} \PY{n+nf}{callback\PYZus{}on\PYZus{}help\PYZus{}menu\PYZus{}exit}\PY{p}{(}\PY{n}{help\PYZus{}menu}\PY{p}{)}\PY{p}{:}

            \PY{c}{\PYZsh{} Going back to previous input state}
            \PY{c}{\PYZsh{}}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}pop\PYZus{}input\PYZus{}state\PYZus{}from\PYZus{}stack}\PY{p}{(}\PY{p}{)}

            \PY{k}{return}

        \PY{c}{\PYZsh{} Sound to be played when help menu is opened}
        \PY{c}{\PYZsh{}}
        \PY{n+nb}{file} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{assets}\PY{o}{.}\PY{n}{fetch}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{help\PYZus{}menu.ogg}\PY{l+s}{\PYZsq{}}\PY{p}{)}
        \PY{n}{help\PYZus{}menu\PYZus{}sound} \PY{o}{=} \PY{n}{pygame}\PY{o}{.}\PY{n}{mixer}\PY{o}{.}\PY{n}{Sound}\PY{p}{(}\PY{n+nb}{file}\PY{p}{)}

        \PY{n}{help\PYZus{}menu} \PY{o}{=} \PY{n}{TextMenuList}\PY{p}{(}\PY{n}{help\PYZus{}menu\PYZus{}entries}\PY{p}{,}
                                 \PY{n}{help\PYZus{}menu\PYZus{}sound}\PY{p}{,}
                                 \PY{n+nb+bp}{None}\PY{p}{,}
                                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{channel\PYZus{}system}\PY{p}{,}
                                 \PY{n}{callback\PYZus{}on\PYZus{}help\PYZus{}entry\PYZus{}selected}\PY{p}{,}
                                 \PY{n}{callback\PYZus{}on\PYZus{}help\PYZus{}menu\PYZus{}exit}\PY{p}{,}
                                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tts\PYZus{}engine}\PY{p}{)}

        \PY{k}{return} \PY{n}{help\PYZus{}menu}
\end{Verbatim}
